<?xml version="1.0" encoding="UTF-8"?>
<metamorph xmlns="http://www.culturegraph.org/metamorph" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	version="1">
	<!-- Aleph MAB2 XML to RDF - a mapping of the hbz01 catalog to lobid-resources -->
	<!-- beware: the sequence of the rules are semantically important! Don't change the order. -->
	<!-- Aleph MAB differs from MAB in that: -->
	<!-- an indicator2 exists -->
	<!-- every field has at least the subfield 'a' -->
	<!-- => structure of alehp MAB: $field$indicator1$indicator2$subfield -->
	<vars>
		<var name="ns-lobid-resource" value="http://lobid.org/resource/"/>
		<var name="ns-lobid-vocab" value="http://purl.org/lobid/lv#"/>
		<var name="ns-lobid-organisation" value="http://lobid.org/organisation/"/>
		<var name="ns-zdb-services" value="http://ld.zdb-services.de/resource/"/>
	</vars>
	<rules>
		<!-- ####################### -->
		<!-- ####### Get subject uri of each record -->
		<!-- ####################### -->
		<data source="001-[-1].a" name="@id"/>
		<!-- get also the ZDB id to mint it -->
		<data source="025z[-1].a" name="@idzdb"/>
		<!-- ####################### -->
		<!-- ####### hbz ID sameAs ZDB ID -->
		<!-- ####################### -->
		<combine name="http://www.w3.org/2002/07/owl#sameAs" value="$[ns-zdb-services]${idzdb}">
			<data source="@idzdb" name="idzdb"/>
		</combine>
		<data source="@idzdb" name="$[ns-lobid-vocab]zdbID"/>
		<combine name="http://www.w3.org/2002/07/owl#sameAs" value="${idzdb}">
			<data source="@id"/>
			<data source="@idzdb" name="idzdb">
				<regexp match="(.*)" format="$[ns-lobid-resource]ZDB${1}"/>
			</data>
		</combine>
		<!-- ####################### -->
		<!-- ####### Secondary form, link to primary form and vice verso -->
		<!-- ####################### -->
		<data source="021[-b]1.a" name="http://purl.org/dc/terms/source">
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}"/>
		</data>
		<data source="021[-b]1.a" name="http://purl.org/dc/terms/isFormatOf">
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}"/>
		</data>
		<!-- temporarily set new subject id -->
		<data name="~rdf:subject" source="021[-b]1.a">
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}"/>
		</data>
		<combine name="http://purl.org/dc/terms/hasFormat" value="$[ns-lobid-resource]${subjectid}">
			<data source="021[-b]1.a" name=""/>
			<data source="@id" name="subjectid"/>
		</combine>
		<!-- set subject uri of resource anew -->
		<combine name="~rdf:subject" value="$[ns-lobid-resource]${subject}">
			<data source="@id" name="subject"/>
			<data source="021[-b]1.a"/>
		</combine>
		<!-- ####################### -->
		<!-- ####### Child, link to parent and vice versa, e.g. HT000009600 -->
		<!-- ####################### -->
		<data source="4[56789]3[-abr][-12].a" name="@idTitleSeries"/>
		<data source="010-1.a|529z1.9|@idTitleSeries" name="@isPartOfHbzId"/>
		<!-- temporarily set new subject uri -->
		<data name="~rdf:subject" source="010-1.a|529z1.9|@idTitleSeries">
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}"/>
		</data>
		<combine name="http://purl.org/dc/terms/hasPart" value="$[ns-lobid-resource]${subjectid}">
			<data source="010-1.a|529z1.9|@idTitleSeries" name=""/>
			<data source="@id" name="subjectid"/>
		</combine>
		<data source="010-1.a|529z1.9|@idTitleSeries" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/ontology/bibo/Collection"/>
		</data>
		<!-- set subject uri of resource anew -->
		<combine name="~rdf:subject" value="$[ns-lobid-resource]${subject}">
			<data source="@id" name="subject"/>
			<data source="010-1.a|529z1.9|@idTitleSeries"/>
		</combine>
		<!-- ####################### -->
		<!-- ####### provenance not used for now, see https://github.com/lobid/lodmill/issues/541 -->
		<!-- ####################### -->
		<!-- <data source="@idzdb" name="@idzdbProvenance"> <regexp match="(.*)" format="$[ns-lobid-resource]${1}/about"/> 
			</data> <data source="@idzdbProvenance" name="~rdf:subject"/> <data source="@idzdb" name="http://xmlns.com/foaf/0.1/primaryTopic"> 
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}"/> </data> <combine name=" :subject" 
			value="$[ns-lobid-resource]${id}/about"> <if> <none> <data source="@idzdbProvenance"/> </none> 
			</if> <data source="@id" name="id"> <regexp match="(.*)" format="${1}"/> </data> </combine> 
			<combine name="~rdf:subject" value="$[ns-lobid-resource]${id}/about"> <data source="@idzdb"/> 
			<data source="@id" name="id"> <regexp match="(.*)" format="${1}"/> </data> </combine> <data 
			source="@idzdbProvenance" name="http://vocab.deri.ie/void#inDataset"> <regexp match=".*" format="http://lobid.org/dataset/resource"/> 
			</data> <combine name="http://vocab.deri.ie/void#inDataset" value="http://lobid.org/dataset/resource"> 
			<if> <none> <data source="@idzdbProvenance"/> </none> </if> <data source="@id"/> </combine> 
			<combine name="http://vocab.deri.ie/void#inDataset" value="http://lobid.org/dataset/resource"> 
			<data source="@idzdb"/> <data source="@id"/> </combine> <combine name="http://xmlns.com/foaf/0.1/primaryTopic" 
			value="$[ns-lobid-resource]${id}"> <if> <none> <data source="@idzdbProvenance"/> </none> </if> 
			<data source="@id" name="id"> <regexp match="(.*)" format="${1}"/> </data> </combine> <combine 
			name="http://xmlns.com/foaf/0.1/primaryTopic" value="$[ns-lobid-resource]${id}"> <data source="@idzdb"/> 
			<data source="@id" name="id"> <regexp match="(.*)" format="${1}"/> </data> </combine> -->
		<!-- ####################### -->
		<!-- ####### Set main subject uri -->
		<!-- ####################### -->
		<data source="@idzdb" name="~rdf:subject">
			<regexp match="(.*)" format="$[ns-lobid-resource]ZDB${1}"/>
		</data>
		<combine name="http://www.w3.org/2002/07/owl#sameAs" value="$[ns-lobid-resource]${id}">
			<data source="@idzdb"/>
			<data source="@id" name="id"/>
		</combine>
		<!-- set zdbId also for ZDB subjects -->
		<combine value="$[ns-lobid-resource]ZDB${a}/about" name="http://www.w3.org/2007/05/powder-s#describedby">
			<data source="@idzdb" name="a"/>
			<data source="@id"/>
		</combine>
		<combine name="~rdf:subject" value="$[ns-lobid-resource]${id}">
			<data source="@idzdb"/>
			<data source="@id" name="id"/>
		</combine>
		<!-- ####################### -->
		<!-- ####### Set owl:sameAs -->
		<!-- ####################### -->
		<combine name="http://www.w3.org/2002/07/owl#sameAs" value="http://hub.culturegraph.org/resource/HBZ-${id}">
			<if>
				<none>
					<data source="@idzdb"/>
				</none>
			</if>
			<data source="@id" name="id"/>
		</combine>
		<!-- ####################### -->
		<!-- ####### General attributes for each record -->
		<!-- ####################### -->
		<combine name="http://xmlns.com/foaf/0.1/isPrimaryTopicOf" value="${primaryTopic}">
			<if>
				<none>
					<data source="@idzdb"/>
				</none>
			</if>
			<data source="@id" name="primaryTopic">
				<regexp match="(.*)" format="http://193.30.112.134/F/?func=find-c&amp;ccl_term=IDN%3D${1}"/>
			</data>
		</combine>
		<combine name="http://xmlns.com/foaf/0.1/isPrimaryTopicOf" value="${primaryTopic}">
			<data source="@idzdb"/>
			<data source="@id" name="primaryTopic">
				<regexp match="(.*)" format="http://193.30.112.134/F/?func=find-c&amp;ccl_term=IDN%3D${1}"/>
			</data>
		</combine>
		<data source="@id" name="$[ns-lobid-vocab]hbzID"/>
		<data source="@idzdb" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/dc/terms/BibliographicResource"/>
		</data>
		<combine name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type" value="http://purl.org/dc/terms/BibliographicResource">
			<if>
				<none>
					<data source="@idzdb"/>
				</none>
			</if>
			<data source="@id"/>
		</combine>
		<data source="@id" name="http://www.w3.org/2007/05/powder-s#describedby">
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}/about"/>
		</data>
		<data source="025z[2].a" name="http://purl.org/dc/terms/isPartOf">
			<regexp match="(.*)" format="$[ns-zdb-services]${1}"/>
		</data>
		<data source="025o[-12].a" name="@oclcnum"/>
		<data source="@oclcnum" name="http://www.w3.org/2002/07/owl#sameAs">
			<regexp match="(.*)" format="http://worldcat.org/oclc/${1}"/>
		</data>
		<data source="@oclcnum" name="http://purl.org/ontology/bibo/oclcnum"/>
		<combine name="http://purl.org/ontology/bibo/oclcnum" value="${num}">
			<if>
				<none>
					<data source="@idzdb"/>
				</none>
			</if>
			<data source="@oclcnum" name="num"/>
		</combine>
		<!-- ####################### -->
		<!-- ################ language -->
		<!-- ####################### -->
		<data source="037[-abc][-123].a" name="@639-2"/>
		<data source="@639-2" name="@language">
			<lookup in="iso639xToIso639-3-Map"/>
		</data>
		<data source="@language" name="http://purl.org/dc/terms/language">
			<regexp match="(.*)" format="http://id.loc.gov/vocabulary/iso639-2/${1}"/>
		</data>
		<!-- ####################### -->
		<!-- ########## carrier and type -->
		<!-- ####################### -->
		<!-- type is book (and also manifestation) if 050 begins with 'a' and 051 or 052 is missing 
			or 051 and 052 does not fulfill a certain pattern -->
		<data source="051." name="@type"/>
		<combine name="@rdftypeAndManifestation" value="http://purl.org/ontology/bibo/Book">
			<if>
				<none>
					<data source="@typeOnly"/>
					<data source="@idzdb"/>
					<data source="051.">
						<regexp match="^a"/>
					</data>
					<data source="051.">
						<regexp match="^.[mt]"/>
					</data>
					<data source="051.">
						<regexp match="^..[tm]"/>
					</data>
					<data source="051.">
						<regexp match="^...t"/>
					</data>
					<data source="051.">
						<regexp match="^....t"/>
					</data>
					<data source="051.">
						<regexp match="^.....t"/>
					</data>
					<data source="052.">
						<regexp match="^[{alpha}|]"/>
					</data>
					<data source="@matVideo"/>
					<data source="@mediumAudio"/>
				</none>
			</if>
			<data source="050.">
				<regexp match="^a"/>
			</data>
		</combine>
		<!-- print -->
		<data source="050." name="@medium">
			<regexp match="^[abcd]" format="http://rdvocab.info/termList/RDAproductionMethod/1010"/>
		</data>
		<data source="050." name="@medium">
			<regexp match="^.......a" format="http://rdvocab.info/termList/RDAproductionMethod/1010"/>
		</data>
		<!-- multimedia -->
		<data source="050." name="@medium">
			<regexp match="^.......a" format="http://iflastandards.info/ns/isbd/terms/mediatype/T1008"/>
		</data>
		<!--audio -->
		<data source="050." name="@mediumAudio">
			<regexp match="^.....a" format="http://purl.org/ontology/bibo/AudioDocument"/>
		</data>
		<data source="@mediumAudio" name="@medium"/>
		<data source="334-[12].a" name="@mediumAudio">
			<regexp match="^[Tt][oO]" format="http://purl.org/ontology/bibo/AudioDocument"/>
		</data>
		<!--audio visual video -->
		<data source="050." name="@matVideo">
			<regexp match="^.....[bc]"/>
		</data>
		<data source="@matVideo" name="@medium">
			<regexp match=".*" format="http://purl.org/ontology/bibo/AudioVisualDocument"/>
		</data>
		<data source="@matVideo" name="@medium">
			<regexp match=".*" format="http://rdvocab.info/termList/RDACarrierType/1050"/>
		</data>
		<data source="334-[12].a" name="@medium">
			<regexp match="^Bildton" format="http://purl.org/ontology/bibo/AudioVisualDocument"/>
		</data>
		<!-- picture -->
		<data source="050." name="@rdftypeAndManifestation">
			<regexp match="^.....d" format="http://purl.org/ontology/bibo/Image"/>
		</data>
		<data source="@matVideo" name="@medium">
			<regexp match=".*" format="http://rdvocab.info/termList/RDAMediaType/1005"/>
		</data>
		<data source="334-[12].a" name="@medium">
			<regexp match="^Bildli" format="http://purl.org/ontology/bibo/Image"/>
		</data>
		<!-- microform -->
		<data source="050." name="@medium">
			<regexp match="^...[abc]" format="http://rdvocab.info/termList/RDACarrierType/1020"/>
		</data>
		<data source="334-[12].a" name="@medium">
			<regexp match="^Mikrofor" format="http://rdvocab.info/termList/RDACarrierType/1020"/>
		</data>
		<data source="057." name="@medium">
			<regexp match=".*" format="http://rdvocab.info/termList/RDACarrierType/1020"/>
		</data>
		<data source="050." name="@manifestation">
			<regexp match="^...[abc]"/>
		</data>
		<data source="050." name="@manifestation">
			<regexp match="^......a"/>
		</data>
		<!-- Dini Kim , TODO dcterms:medium "rdacarrier:1044" (unmediated) -->
		<!-- map -->
		<data source="050." name="@medium">
			<regexp match="^..........a" format="http://purl.org/ontology/bibo/Map"/>
		</data>
		<!-- vinyl -->
		<data source="050." name="@mediumAudio">
			<regexp match="^.....aj" format="http://purl.org/ontology/mo/Vinyl"/>
		</data>
		<data source="050." name="@mediumAudio">
			<regexp match="^.....aj" format="http://purl.org/ontology/bibo/AudioDocument"/>
		</data>
		<!-- audio cassette -->
		<data source="050." name="@mediumAudio">
			<regexp match="^.....ad" format="http://purl.org/library/CassetteTape"/>
		</data>
		<!-- braille -->
		<data source="050." name="@medium">
			<regexp match="^....a" format="http://purl.org/library/BrailleBook"/>
		</data>
		<data source="050." name="@medium">
			<regexp match="^....a" format="http://rdvocab.info/termList/RDAproductionMethod/1010"/>
		</data>
		<!-- game -->
		<data source="050." name="@rdftypeAndManifestation">
			<regexp match="^.........a" format="http://purl.org/library/Game"/>
		</data>
		<!-- manuscript -->
		<data source="050." name="@medium">
			<regexp match="^.a" format="http://rdvocab.info/termList/prodManuscript/1002"/>
		</data>
		<!-- Computer carriers -->
		<data source="050." name="@medium">
			<regexp match="^........[abcdefgz]" format="http://rdvocab.info/termList/RDACarrierType/1010"/>
		</data>
		<data source="@rdftypeAndManifestation" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
		<!-- shortcut for type/medium being also ever a "manifestation" -->
		<data source="@rdftypeAndManifestation" name="@manifestation"/>
		<data source="@medium" name="@manifestation"/>
		<data source="@manifestation" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/vocab/frbr/core#Manifestation"/>
		</data>
		<data source="@typeOnly" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
		<!-- 051: type -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^a|^.t|^..t|^...t|^.....t" format="http://purl.org/ontology/bibo/Article"/>
		</data>
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^[nt]" format="http://purl.org/ontology/bibo/MultiVolumeBook"/>
		</data>
		<combine name="@rdftypeAndManifestation" value="http://purl.org/ontology/bibo/Book">
			<if>
				<none>
					<data source="@matVideo"/>
					<data source="@mediumAudio"/>
					<data source="050.">
						<regexp match="^.........a"/>
					</data>
				</none>
			</if>
			<data source="051.">
				<regexp match="^m|^.x|^..x|^...x|^....[fkls]"/>
			</data>
		</combine>
		<!-- music -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.m|^..m|^...m" format="http://purl.org/ontology/mo/PublishedScore"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.mu|^...mu|^.....mu" format="http://purl.org/ontology/mo/PublishedScore"/>
		</data>
		<!-- amtliche Druckschrift -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^......[bfiklmorsu]" format="$[ns-lobid-vocab]OfficialPublication"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.aa|^............[bfiklmorsu]" format="$[ns-lobid-vocab]OfficialPublication"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.aa|^...aa|^.....aa" format="$[ns-lobid-vocab]OfficialPublication"/>
		</data>
		<!-- bibliography -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.[b]|^..[b]|^...[b]" format="$[ns-lobid-vocab]Bibliography"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.b[i]|^...b[i]|^.....b[i]" format="$[ns-lobid-vocab]Bibliography"/>
		</data>
		<!-- biography -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.[h]|^..[h]|^...[h]" format="$[ns-lobid-vocab]Biography"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.b[g]|^...b[g]|^.....b[g]" format="$[ns-lobid-vocab]Biography"/>
		</data>
		<!-- festschrift -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.f|^..f|^...f" format="$[ns-lobid-vocab]Festschrift"/>
		</data>
		<!-- reference source -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.[de]|^..[de]|^...[de]" format="http://purl.org/ontology/bibo/ReferenceSource"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.ez|^...ez|^.....ez" format="http://purl.org/ontology/bibo/ReferenceSource"/>
		</data>
		<!-- norm -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.n|^..n|^...n" format="http://purl.org/ontology/bibo/Standard"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.no|^...no|^.....no" format="http://purl.org/ontology/bibo/Standard"/>
		</data>
		<!-- norm -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.x|^..x|^...x" format="$[ns-lobid-vocab]Schoolbook"/>
		</data>
		<!-- legislation -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.l|^..l|^...l" format="$[ns-lobid-vocab]Legislation"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.ag|^...ag|^.....ag" format="$[ns-lobid-vocab]Legislation"/>
		</data>
		<!-- thesis -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.[uy]|^..[uy]|^...[uy]" format="http://purl.org/ontology/bibo/Thesis"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.sc|^...sc|^.....sc" format="http://purl.org/ontology/bibo/Thesis"/>
		</data>
		<!-- proceedings -->
		<data source="051." name="@rdftypeAndManifestation">
			<regexp match="^.k|^..k|^...k" format="http://purl.org/ontology/bibo/Proceedings"/>
		</data>
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^.ko|^...ko|^.....ko" format="http://purl.org/ontology/bibo/Proceedings"/>
		</data>
		<!-- 052: type -->
		<data source="052." name="@rdftypeAndManifestation">
			<regexp match="^[af]|^.au|^...au|^.....au" format="http://purl.org/ontology/bibo/Article"/>
		</data>
		<data source="052." name="@collection">
			<regexp match="^[jp].*|^.il.*|^...il.*|^.....il.*" format="http://purl.org/ontology/bibo/Journal"/>
		</data>
		<data source="052." name="@collection">
			<regexp match="^r|^.se|^...se|^.....se" format="http://purl.org/ontology/bibo/Series"/>
		</data>
		<data source="@collection" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/ontology/bibo/Collection"/>
		</data>
		<data source="@collection" name="@typeOnly"/>
		<!-- newspaper -->
		<data source="052." name="@collection">
			<regexp match="^z|^.[ae]o|^...[ae]o|^.....[ae]o" format="http://purl.org/ontology/bibo/Newspaper"/>
		</data>
		<data source="052." name="@collection">
			<regexp match="^z|^.[url]p|^...[url]p|^.....[url]p" format="http://purl.org/ontology/bibo/Newspaper"/>
		</data>
		<!-- online -->
		<data source="050." name="@medium">
			<regexp match="^........g" format="http://rdvocab.info/termList/RDACarrierType/1018"/>
		</data>
		<data source="058." name="@medium">
			<regexp match="^.r" format="http://rdvocab.info/termList/RDACarrierType/1018"/>
		</data>
		<data source="652a[-1].a" name="@medium">
			<regexp match="^[AaOo][rn]" format="http://rdvocab.info/termList/RDACarrierType/1018"/>
		</data>
		<!-- computer carrier (disks etc) -->
		<data source="058." name="@medium">
			<regexp match="^.[^r]" format="http://rdvocab.info/termList/RDACarrierType/1010"/>
		</data>
		<!-- electronic -->
		<data source="@fulltextOnline" name="@medium">
			<regexp match=".*" format="http://rdvocab.info/termList/RDACarrierType/1010"/>
		</data>
		<data source="652a[-1].a" name="@medium">
			<regexp match=".*" format="http://rdvocab.info/termList/RDACarrierType/1010"/>
		</data>
		<data source="@medium" name="http://purl.org/dc/terms/medium"/>
		<!-- set default medium -->
		<combine name="@medium" value="$[ns-lobid-vocab]Miscellaneous" flushWith="record">
			<if>
				<none>
					<data source="@medium">
						<regexp match=".*"/>
					</data>
				</none>
			</if>
			<data source="@id"/>
		</combine>
		<!-- set default type -->
		<combine name="@rdftypeAndManifestation" value="$[ns-lobid-vocab]Miscellaneous"
			flushWith="record">
			<if>
				<none>
					<data source="@rdftypeAndManifestation"/>
					<data source="@rdftypeOnly"/>
				</none>
			</if>
			<data source="@id"/>
		</combine>
		<!-- ####################### -->
		<!-- ########## periodicals, collections -->
		<!-- ####################### -->
		<data source="@idzdb" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/ontology/bibo/Periodical"/>
		</data>
		<data source="@idzdb" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/ontology/bibo/Collection"/>
		</data>
		<!-- ####################### -->
		<!-- ########## title -->
		<!-- ####################### -->
		<data source="304[-a]1.a" name="http://purl.org/dc/terms/alternative"/>
		<data source="310[-ab][-12].a" name="@title"/>
		<data source="@title" name="http://purl.org/dc/terms/title">
			<replace pattern="&gt;" with=""/>
			<replace pattern="&lt;" with=""/>
		</data>
		<!-- has other title information. If no title exists yet, use this as title. -->
		<combine name="@otherTitle" value="${titleRemainder}" sameEntity="true">
			<data source="@title"/>
			<data source="33[13][-ab][-1].a" name="titleRemainder">
				<regexp match="(.*)" format="${1}"/>
			</data>
		</combine>
		<combine name="@title" value="${title}">
			<if>
				<none>
					<data source="@title"/>
				</none>
			</if>
			<data source="33[13][-ab][-1].a" name="title"/>
		</combine>
		<!-- deliberatley not everything linked with OR '|' because of performance problems -->
		<data source="335[-abcd][-12].a|370[a][-12].a" name="@otherTitle"/>
		<data source="3[45][01234567][-ab][-12].[ab]" name="http://purl.org/dc/terms/alternative"/>
		<data source="35[012345][-ab][-1].a" name="@otherTitle"/>
		<data source="36[0123456789][-abcd][-12].a" name="@otherTitle"/>
		<data source="376[-adb][-12].[ad]" name="http://purl.org/ontology/bibo/shortTitle"/>
		<data source="504-[12].a" name="http://purl.org/dc/terms/alternative"/>
		<data source="8[012][0123456789][-ab][-12].a|C[136][0135][-ab][-12].a" name="@otherTitle"/>
		<data source="@otherTitle" name="http://rdvocab.info/Elements/otherTitleInformation">
			<replace pattern="&gt;" with=""/>
			<replace pattern="&lt;" with=""/>
		</data>
		<data source="675[-abcd][-12].a" name="$[ns-lobid-vocab]titleKeyword"/>
		<!-- ####################### -->
		<!-- ########## date issued -->
		<!-- ####################### -->
		<!-- range of date. Only if 021 not exists but one of 425[bc]. Take 4 digits. -->
		<combine name="@dateRange" value="${dateStart} - ${dateEnd}" flushWith="record">
			<if>
				<none>
					<data source="021[-b]1.a"/>
				</none>
			</if>
			<data source="425b[-1].a" name="dateStart">
				<regexp match="(\d{4})" format="${1}"/>
			</data>
			<data source="425c[-1].a" name="dateEnd">
				<regexp match="(\d{4})" format="${1}"/>
			</data>
		</combine>
		<data source="@dateRange" name="http://purl.org/dc/terms/issued">
			<regexp match="^\d{4}.*"/>
		</data>
		<!-- issue precedence -->
		<data source="425a[-1].a" name="@dateFix"/>
		<combine name="@dateFix" value="${a}">
			<if>
				<none>
					<data source="@dateFix"/>
				</none>
			</if>
			<data source="425b[-1].a" name="a"/>
		</combine>
		<combine name="@dateFix" value="${a}">
			<if>
				<none>
					<data source="@dateFix"/>
				</none>
			</if>
			<data source="425c[-1].a" name="a">
			</data>
		</combine>
		<combine name="@dateFix" value="${a}">
			<if>
				<none>
					<data source="@dateFix"/>
				</none>
			</if>
			<data source="425-[-1].a" name="a"/>
		</combine>
		<combine name="@dateFix" value="${a}">
			<if>
				<none>
					<data source="@dateFix"/>
				</none>
			</if>
			<data source="425p[-1].a" name="a">
			</data>
		</combine>
		<combine name="@dateFix" value="${a}">
			<if>
				<none>
					<data source="@dateFix"/>
				</none>
			</if>
			<data source="595-[-12].a" name="a">
			</data>
		</combine>
		<combine name="@dateFix" value="${a}">
			<if>
				<none>
					<data source="@dateFix"/>
				</none>
			</if>
			<data source="089-[-1].a" name="a">
			</data>
		</combine>
		<!-- date validation. Field must begin with 4 digits -->
		<data source="@dateFix|@dateSecondary" name="http://purl.org/dc/terms/issued">
			<regexp match="^\d{4}.*"/>
		</data>
		<!-- semantic shift: 425 is only date of issue if resource is not a secondary form (21) -->
		<combine name="@dateSecondary" value="${dateSecondary}">
			<data source="021[-b]1.a"/>
			<data source="619a[-1].a" name="dateSecondary">
				<regexp match="(\d{4})" format="${1}"/>
			</data>
		</combine>
		<!-- ####################### -->
		<!-- ########## geo coordinates -->
		<!-- ####################### -->
		<data source="407-[123].a" name="http://rdvocab.info/Elements/longitudeAndLatitude">
			<regexp match="\((.*)\)" format="${1}"/>
		</data>
		<!-- ####################### -->
		<!-- ########## publisher -->
		<!-- ####################### -->
		<data source="41[058][-abcu][-12].a|594[-abc][-12].a|61[14][-abcu][-12].a|673[-abc]-.a"
			name="http://rdvocab.info/Elements/placeOfPublication"/>
		<data source="41[278][-abcu][-12].[ag]|61[36][-abcu][-12].a" name="http://purl.org/dc/elements/1.1/publisher"/>
		<!-- TODO if multiple publisher these are melted to one. See HT015082724 -->
		<combine name="http://rdvocab.info/Elements/publicationStatement" value="${publicationConcat}"
			sameEntity="true">
			<concat delimiter="; " name="publicationConcat">
				<data source="41[058][-abcu][-12].a|594[-abc][-12].a|61[14][-abcu][-12].a|673[-abc]-.a"/>
				<data source="41[278][-abcu][-12].[ag]|61[36][-abcu][-12].a"/>
				<data source="@dateFix"/>
			</concat>
		</combine>
		<!-- |674[-abc][-12].a <= YearOfPublication of the primary form. TODO find property -->
		<!-- ####################### -->
		<!-- ########## description extent -->
		<!-- ####################### -->
		<data source="43[3457][-abc][-1].[aq]" name="http://iflastandards.info/ns/isbd/elements/P1053"/>
		<!-- ####################### -->
		<!-- ################ edition -->
		<!-- ####################### -->
		<data source="40[03]-1.[an]|510-1.a" name="http://purl.org/ontology/bibo/edition"/>
		<!-- ####################### -->
		<!-- ########## links to the fulltext, online doi, toc etc. -->
		<!-- ####################### -->
		<!-- doi -->
		<data source="552a[-1].a" name="http://umbel.org/umbel#isLike">
			<regexp match="(.*)" format="http://dx.doi.org/${1}"/>
		</data>
		<data source="552a[-1].a" name="http://purl.org/ontology/bibo/doi"/>
		<!-- TODO "552a[-1].a" => "http://purl.org/ontology/bibo/doi", -->
		<!-- urn -->
		<data source="552b[-1].a" name="@urn">
			<regexp match="(^.*:.*\d+)$" format="${1}"/>
		</data>
		<data source="@urn" name="$[ns-lobid-vocab]urn"/>
		<data source="@urn" name="http://umbel.org/umbel#isLike">
			<regexp match="(.*)" format="http://nbn-resolving.de/${1}"/>
		</data>
		<!-- fulltext online , if 655 AND 334 exists with "[eE][lL]"ektro.. -->
		<data source="655[-e][ -1].u" name="@linkUri">
			<regexp match="(.*)" format="${1}"/>
		</data>
		<!-- ####################### -->
		<!-- ################ items -->
		<!-- ####################### -->
		<!-- reset Item id for we will coin a new one <data source="088 ?.a" name="~rdf:subject"> -->
		<data source="088 ?.a" name="@sigel2isilMap">
			<lookup in="sigel2isilMap"/>
		</data>
		<combine name="@itemId" value="http://lobid.org/item/${id}:${isil}:${signature}"
			flushWith="088??" reset="false">
			<data source="@id" name="id"/>
			<data source="088 ?.c" name="signature">
				<urlescape></urlescape>
			</data>
			<data source="@sigel2isilMap" name="isil"/>
		</combine>
		<!-- new coined subject uri of the Item -->
		<data source="@itemId" name="~rdf:subject"/>
		<data source="@itemId" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://purl.org/vocab/frbr/core#Item"/>
		</data>
		<data source="@itemId" name="http://www.w3.org/2007/05/powder-s#describedby">
			<regexp match="(.*)" format="${1}/about"/>
		</data>
		<combine name="http://purl.org/vocab/frbr/core#exemplarOf" value="$[ns-lobid-resource]${id}">
			<data source="@id" name="id"/>
			<data source="@itemId"/>
		</combine>
		<combine name="http://purl.org/vocab/frbr/core#owner" value="$[ns-lobid-organisation]${isil}"
			sameEntity="true">
			<data source="@itemId"/>
			<data source="@sigel2isilMap" name="isil"/>
		</combine>
		<combine name="http://purl.org/ontology/daia/label" value="${signature}"
			sameEntity="true">
			<data source="@itemId"/>
			<data source="088 ?.c" name="signature"/>
		</combine>
		<!-- provenance -->
		<!-- <combine name="~rdf:subject" value="${itemId}/about"> <data source="@itemId" name="itemId"> 
			<regexp match="(.*)" format="${1}"/> </data> </combine> <data source="@itemId" name="http://vocab.deri.ie/void#inDataset"> 
			<regexp match=".*" format="http://lobid.org/dataset/resource"/> </data> <combine name="http://xmlns.com/foaf/0.1/primaryTopic" 
			value="${itemId}"> <data source="@itemId" name="itemId"> <regexp match="(.*)" format="${1}"/> 
			</data> </combine> -->
		<!-- set subject uri of resource anew -->
		<combine name="~rdf:subject" value="$[ns-lobid-resource]${subject}">
			<data source="@id" name="subject"/>
		</combine>
		<combine name="~rdf:subject" value="$[ns-lobid-resource]${subject}">
			<data source="@id" name="subject"/>
			<data source="@itemId"/>
		</combine>
		<data source="@itemId" name="http://purl.org/vocab/frbr/core#exemplar"/>
		<!-- ####################### -->
		<!-- ########## volume -->
		<!-- ####################### -->
		<!-- 32-[-12].a is not bibo:volume - but what is it? -->
		<data source="089-[-1].a|432-[-12].a|090-[-1].a" name="http://purl.org/ontology/bibo/volume"/>
		<!-- ####################### -->
		<!-- #######creator -->
		<!-- ####################### -->
		<!-- person links -->
		<data source="1[0123456789][0123456789][-aemn]1.9|8[012][02468][-mn]1.9" name="@creator">
			<regexp match="\(DE-588\)(.*)" format="http://d-nb.info/gnd/${1}"/>
		</data>
		<data source="@creator" name="http://purl.org/dc/terms/creator"/>
		<!-- corporation links as creator -->
		<data source="2[0123456789][012345678][-a][12-].9|8[012][02468][-mn]-.9" name="http://purl.org/dc/terms/creator">
			<regexp match="\(DE-588\)(.*)" format="http://d-nb.info/gnd/${1}"/>
		</data>
		<!-- literals of creator -->
		<data source="359[-ab][-1].a" name="http://rdvocab.info/Elements/statementOfResponsibility"/>
		<combine name="http://purl.org/dc/elements/1.1/creator" value="${creatorLiteral}"
			sameEntity="true">
			<if>
				<none>
					<data source="@creator"/>
				</none>
			</if>
			<data source="1[0123456789][0123456789][-acefmn]2.[pa]|8[012][02468][-mn]1.[pa]"
				name="creatorLiteral"/>
		</combine>
		<!-- ####################### -->
		<!-- ################ contributor -->
		<!-- ####################### -->
		<!-- contributors with roles @TODO many roles needs tests -->
		<data source="1[0123456789][0123456789]b[1234].b" name="@marcrelName"/>
		<!-- person links -->
		<data source="1[0123456789][0123456789][bcp][1234].9" name="@contributorId">
			<regexp match="\(DE-588\)(.*)" format="http://d-nb.info/gnd/${1}"/>
		</data>
		<!-- corporation links as contributor -->
		<data source="2[0123456789][012345678][bcp][1234].9" name="@contributorId">
			<regexp match="\(DE-588\)(.*)" format="http://d-nb.info/gnd/${1}"/>
		</data>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[dD]ars" format="http://id.loc.gov/vocabulary/relators/act"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[hH]rsg" format="http://purl.org/ontology/bibo/editor"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[rR]egi" format="http://id.loc.gov/vocabulary/relators/drt"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="bers" format="http://purl.org/ontology/bibo/translator"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[iI]ll" format="http://id.loc.gov/vocabulary/relators/ill"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[zZ]eichn" format="http://id.loc.gov/vocabulary/relators/ill"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="^[mM]itarb" format="http://id.loc.gov/vocabulary/relators/clb"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match=".*[oO]togr.*" format="http://id.loc.gov/vocabulary/relators/pht"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match=".*[dD]ir" format="http://id.loc.gov/vocabulary/relators/cnd"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[kK]om" format="http://id.loc.gov/vocabulary/relators/cmp"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[vV]or" format="http://id.loc.gov/vocabulary/relators/aui"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[dD]rehb" format="http://id.loc.gov/vocabulary/relators/aus"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[sS]ammler" format="http://id.loc.gov/vocabulary/relators/col"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[bB]eitr" format="http://id.loc.gov/vocabulary/relators/ctb"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[iI]nterpr" format="http://id.loc.gov/vocabulary/relators/prf"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[kK]amera" format="http://id.loc.gov/vocabulary/relators/cng"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[vV]orl" format="http://id.loc.gov/vocabulary/relators/ant"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[gG]esang" format="http://id.loc.gov/vocabulary/relators/sng"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[iI]nterviewer" format="http://id.loc.gov/vocabulary/relators/ivr"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[iI]nterviewter" format="http://id.loc.gov/vocabulary/relators/ive"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[kK]artogra" format="http://id.loc.gov/vocabulary/relators/ctg"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[mM]usi" format="http://id.loc.gov/vocabulary/relators/mus"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[nN]ach" format="http://id.loc.gov/vocabulary/relators/aft"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[pP]rod" format="http://id.loc.gov/vocabulary/relators/pro"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[sS]techer" format="http://id.loc.gov/vocabulary/relators/egr"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<combine name="${marcrel}" value="${contributorId}" sameEntity="true">
			<data source="@marcrelName" name="marcrel">
				<regexp match="[wW]idmun" format="http://id.loc.gov/vocabulary/relators/dte"/>
			</data>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<data source="104f1.9" name="http://id.loc.gov/vocabulary/relators/hnr">
			<regexp match="\(DE-588\)(.*)" format="http://d-nb.info/gnd/${1}"/>
		</data>
		<!-- default: if none of the above matches and @marcrelName and @contributorId exists => 
			dc:contributor -->
		<combine name="http://purl.org/dc/terms/contributor" value="${contributorId}">
			<if>
				<none>
					<data source="@marcrelName">
						<regexp
							match="[dD]ars|[hH]rsg|[rR]egi|bers|[iI]ll|[zZ]eichn|[mM]itarb|[oO]togr|[dD]ir|[kK]om|[vV]or|[dD]rehb|[sS]ammler|[bB]eitr|[iI]nterpr|[kK]amera|[vV]orl|[gG]esang|[iI]nterviewer|[iI]nterviewter|[kK]artogra|[mM]usi|[nN]ach|[pP]rod|[sS]techer|[wW]idmun"/>
					</data>
				</none>
			</if>
			<data source="@contributorId" name="contributorId"/>
		</combine>
		<data source="@contributorId" name="http://purl.org/dc/terms/contributor"/>
		<!-- if there are only literals for contributor: -->
		<combine name="http://purl.org/dc/elements/1.1/contributor" value="${contributorLiteral}">
			<if>
				<none>
					<data source="@contributorId">
					</data>
				</none>
			</if>
			<data source="1[0123456789][0123456789]b1.a" name="contributorLiteral"/>
		</combine>
		<!-- ####################### -->
		<!-- #######subjects -->
		<!-- ####################### -->
		<!-- ddc links -->
		<data source="70[05][-b][-12345].a" name="http://purl.org/dc/terms/subject">
			<regexp match="([0-9]{3})" format="http://dewey.info/class/${1}/"/>
		</data>
		<data source="9[01234][27]-[-12].9" name="@subjectLinks">
			<regexp match="\(DE-588\)(.*)" format="http://d-nb.info/gnd/${1}"/>
		</data>
		<data source="@subjectLinks" name="http://purl.org/dc/terms/subject"/>
		<!-- gnd subjects literals, use only if no link present, see e.g. HT015865114 -->
		<combine name="http://purl.org/dc/elements/1.1/subject" value="${subjectName}"
			sameEntity="true">
			<if>
				<none>
					<data source="@subjectLinks">
						<regexp match="^[^.*]"/>
					</data>
				</none>
			</if>
			<data source="9[01234][27][-acfgkpstkz][-12].[sha]" name="subjectName"/>
		</combine>
		<data source="902[-a][-1].f" name="@medium">
			<regexp match="^Karte" format="http://purl.org/ontology/bibo/Map"/>
		</data>
		<!-- ############ schlagwortketten #### -->
		<!-- Note that regular MAB definition uses semantics in indicator field, not in the subfield 
			(as our MAB does here) -->
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="902-1.[cfgkpstz-]"/>
				<data source="903-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="907-1.[cfgkpstz-]"/>
				<data source="908-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="912-1.[cfgkpstz-]"/>
				<data source="913-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="917-1.[cfgkpstz-]"/>
				<data source="918-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="922-1.[cfgkpstz-]"/>
				<data source="923-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="927-1.[cfgkpstz-]"/>
				<data source="928-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="932-1.[cfgkpstz-]"/>
				<data source="933-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="937-1.[cfgkpstz-]"/>
				<data source="938-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="942-1.[cfgkpstz-]"/>
				<data source="943-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<combine name="@subjectChain" value="${a}">
			<concat delimiter=" | " name="a">
				<data source="947-1.[cfgkpstz-]"/>
				<data source="948-1.a">
					<regexp match="(.*)" format="(${1})"/>
				</data>
			</concat>
		</combine>
		<data source="@subjectChain" name="http://purl.org/lobid/lv#subjectChain">
			<replace pattern="\) \| \(" with=","/>
			<replace pattern=" \| \(" with=" \("/>
		</data>
		<!-- ####################### -->
		<!-- ##########fulltext, toc, seeAlso -->
		<!-- ####################### -->
		<combine name="@fulltextOnline" value="${link}">
			<data source="334-[12].a">
				<regexp match="^[eEcC][lLoO]"/>
			</data>
			<data source="@linkUri" name="link">
				<regexp match="^([a-zA-Z].*)" format="${1}"/>
			</data>
		</combine>
		<!--first three chars of "Resolving System" or "Volltext" or "EZB" or "Archivierte Online 
			Ressource "<=> @fulltextOnlineUri -->
		<combine name="@fulltextOnlineUri" value="${uri}" sameEntity="true">
			<data source="655[-eu][ -1].[x3]">
				<regexp match="^[AERV][rZoe][cBls]"/>
			</data>
			<data source="@linkUri" name="uri"/>
		</combine>
		<data source="@fulltextOnlineUri" name="$[ns-lobid-vocab]fulltextOnline"/>
		<data source="@fulltextOnlineUri" name="http://purl.org/dc/terms/hasVersion"/>
		<!-- rdf:seeAlso if 655 AND first three letter "Zusätzliche Angaben" -->
		<combine name="http://www.w3.org/2000/01/rdf-schema#seeAlso" value="${seeAlsoUri}">
			<data source="655[-eu][ -1].[x3]">
				<regexp match="^[Z][u][s]"/>
			</data>
			<data source="@linkUri" name="seeAlsoUri"/>
		</combine>
		<!-- rdf:seeAlso if 655 AND_NOT fulltextOnline -->
		<combine name="http://www.w3.org/2000/01/rdf-schema#seeAlso" value="${seeAlsoUri}">
			<if>
				<none>
					<data source="@fulltextOnline"/>
					<data source="@toc"/>
				</none>
			</if>
			<data source="@linkUri" name="seeAlsoUri"/>
		</combine>
		<!-- link to table of content (toc) -->
		<combine name="@toc" value="${uri}" sameEntity="true">
			<data source="655[-eu][ -1].[x3]">
				<regexp match="^[Ii][Nn][Hh][aA][lL][tT][sS][vV]"/>
			</data>
			<data source="@linkUri" name="uri"/>
		</combine>
		<data source="@toc" name="http://purl.org/dc/terms/tableOfContents"/>
		<!-- ####################### -->
		<!-- ########## source , isPartOf -->
		<!-- ####################### -->
		<concat delimiter="; " name="http://purl.org/dc/terms/bibliographicCitation">
			<data source="59[0123568][-abcd][-12].a"/>
		</concat>
		<data source="525[-a][-1].a" name="http://purl.org/dc/terms/bibliographicCitation"/>
		<!-- if 523-1p and 523-1a -->
		<combine name="http://rdvocab.info/Elements/frequency" value="${p}${a}">
			<data source="523[-a][-1].p" name="p">
				<regexp match="(.*)" format="${1}: "/>
			</data>
			<data source="523[-a][-1].a" name="a"/>
		</combine>
		<!-- if only 523-1a -->
		<combine name="http://rdvocab.info/Elements/frequency" value="${a}">
			<if>
				<none>
					<data source="523[-a][-1].p"/>
				</none>
			</if>
			<data source="523[-a][-1].a" name="a"/>
		</combine>
		<data source="599[-b][-1].[a]" name="@isPartOfHbzId"/>
		<data source="@isPartOfHbzId" name="http://purl.org/dc/terms/isPartOf">
			<regexp match="(.*)" format="$[ns-lobid-resource]${1}"/>
		</data>
		<!--s. #333 <data source="599[abcdefgh][-1].a" name="http://purl.org/dc/terms/isPartOf" /> -->
		<data source="599s[-1].a" name="http://purl.org/dc/terms/isPartOf">
			<regexp match="(.*)" format="$[ns-zdb-services]${1}"/>
		</data>
		<combine name="http://purl.org/dc/elements/1.1/isPartOf" value="${isPartOfLiteral}">
			<if>
				<none>
					<data source="@isPartOfHbzId"/>
				</none>
			</if>
			<data source="451[-ab][12].a" name="isPartOfLiteral">
				<regexp match="(.*) +;.*" format="${1}"/>
			</data>
		</combine>
		<data source="451[-ab][12].a" name="http://purl.org/ontology/bibo/volume">
			<regexp match=".*;(.*)" format="${1}"/>
			<trim></trim>
		</data>
		<!-- ####################### -->
		<!-- ########## classification -->
		<!-- ####################### -->
		<!--nwbib -->
		<data source="078n[-1].a|700n[-1].[ab]" name="http://purl.org/ontology/holding#collectedBy">
			<regexp match=".*" format="$[ns-lobid-resource]NWBib"/>
		</data>
		<data source="700n[-1].a" name="$[ns-lobid-vocab]nwbibsubject">
			<regexp match="(\d\d\d\d\d\d)" format="http://purl.org/lobid/nwbib#s${1}"/>
		</data>
		<!-- ignore '99' in e.g. '700n|a 99|b Bonn', but take 'b' to lookup ID's ,see HT018131501 -->
		<combine name="@nwbib700_99" value="${a}" sameEntity="true">
			<data source="700n[-1].a">
				<regexp match="^99\b"/>
			</data>
			<data source="700n[-1].b" name="a"/>
		</combine>
		<combine name="@nwbib700_99" value="Kreis ${a}" sameEntity="true">
			<data source="700n[-1].a">
				<regexp match="^97\b"/>
			</data>
			<data source="700n[-1].b" name="a"/>
		</combine>
		<combine name="@nwbib700_99" value="Regierungsbezirk ${a}" sameEntity="true">
			<data source="700n[-1].a">
				<regexp match="^96\b"/>
			</data>
			<data source="700n[-1].b" name="a"/>
		</combine>
		<!-- geo enrichment nwbib 99 -->
		<!-- emit field for other pipelined morphs -->
		<data source="@nwbib700_99" name="nwbib700_99"/>
		<data source="@nwbib700_99" name="http://purl.org/dc/elements/1.1/coverage"/>
		<!--some normalizing -->
		<data source="@nwbib700_99" name="@nwbib700_99_id">
			<replace pattern=" " with=""/>
			<replace pattern="/" with=""/>
			<replace pattern="\(.*\)" with=""/>
			<replace pattern="&lt;.*&gt;" with=""/>
			<replace pattern="" with=""/>
			<replace pattern="-" with=""/>
			<replace pattern="," with=""/>
			<replace pattern="/" with=""/>
		</data>
		<!-- wikidata -->
		<data source="@nwbib700_99_id" name="@wikidataId">
			<lookup in="wikidataId"/>
		</data>
		<data source="@wikidataId" name="@wikidataLatLon">
			<lookup in="wikidataLatLon"/>
		</data>
		<data source="@wikidataLatLon" name="$[ns-lobid-vocab]subjectLocation"/>
		<combine name="http://purl.org/dc/terms/spatial" value="http://www.wikidata.org/entity/${id}">
			<data source="@wikidataId" name="id"/>
		</combine>
		<combine name="$[ns-lobid-vocab]nwbibspatial" value="${a}">
			<data source="700n[-1].a" name="a">
				<regexp match="^([0-8][0-8]\b|91\b|96|97)\b" format="http://purl.org/lobid/nwbib-spatial#n${1}"/>
			</data>
		</combine>
		<!--edoweb -->
		<data source="078r1.a" name="@edoweb">
			<regexp match="edoweb"/>
		</data>
		<data source="@edoweb" name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">
			<regexp match=".*" format="http://data.archiveshub.ac.uk/def/ArchivalResource"/>
		</data>
		<data source="@edoweb" name="http://purl.org/ontology/holding#collectedBy">
			<regexp match=".*" format="http://lobid.org/resource/Edoweb"/>
		</data>
		<!--rheinland pfalz -->
		<data source="700l[-1].a" name="http://purl.org/dc/terms/subject">
			<regexp match="^rpb(.*)" format="http://purl.org/lobid/rpb#n${1}"/>
		</data>
		<data source="700l[-1].[ab]" name="http://purl.org/ontology/holding#collectedBy">
			<regexp match="^rpb.*" format="$[ns-lobid-resource]RPB"/>
		</data>
		<!-- ####################### -->
		<!-- ########## isbn -->
		<!-- ####################### -->
		<data source="540[-ab][-1].[ab]" name="http://purl.org/ontology/bibo/isbn">
			<isbn to="clean"/>
		</data>
		<data source="540[-ab][-1].[ab]" name="http://purl.org/ontology/bibo/isbn13">
			<isbn to="isbn13"/>
		</data>
		<!--ISMN -->
		<data source="541[-ab][-12].[ab]" name="http://purl.org/ontology/mo/ismn"/>
		<!-- ISSN -->
		<data source="542[-ab][-1].[a]" name="http://purl.org/ontology/bibo/issn"/>
		<!-- ####################### -->
		<!-- ########## abstract -->
		<!-- ####################### -->
		<data source="750[-abcdefghijklm][-1].a" name="http://purl.org/dc/terms/abstract"/>
		<!-- ####################### -->
		<!-- ############### statistics -->
		<!-- ####################### -->
		<data source="_else"/>
	</rules>
	<!-- ####################### -->
	<!-- ########### maps -->
	<!-- ####################### -->
	<maps>
		<filemap name="sigel2isilMap" files="sigel2isilMap.csv"/>
		<filemap name="iso639xToIso639-3-Map" files="iso639xToIso639-3-Map.tsv"/>
		<sqlmap name="wikidataId" query="SELECT data FROM wikidataGeo WHERE identifier=?"
			host="localhost:3306" database="lobid" login="debian-sys-maint" password="tzSblDEUGC1XhJB7"/>
		<sqlmap name="wikidataLatLon" query="SELECT data FROM wikidataGeo WHERE identifier=?"
			host="localhost:3306" database="lobid" login="debian-sys-maint" password="tzSblDEUGC1XhJB7"/>
	</maps>
</metamorph>
